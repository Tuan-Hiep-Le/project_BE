<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Hi·ªáu S√°ch C·ªßa Hi·ªáp</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">

    <!-- Custom Style -->
    <style>
        body {
          font-family: 'Poppins', sans-serif;
        }
        :root {
          --primary-color: #6C63FF;
          --secondary-color: #F8F9FA;
          --accent-color: #FF6584;
        }
        .btn-primary {
          background-color: var(--primary-color);
          border: none;
        }
        header {
          position: sticky;
          top: 0;
          z-index: 999;
          background-color: var(--secondary-color);
        }
        .card {
          border-radius: 12px;
          box-shadow: 0 4px 8px rgba(0,0,0,0.08);
          transition: transform 0.3s;
        }
        .card:hover {
          transform: scale(1.02);
        }
        .book-card img {
          object-fit: cover;
          height: 300px;
          border-top-left-radius: 12px;
          border-top-right-radius: 12px;
          transition: filter 0.3s;
        }
        .book-card img:hover {
          filter: brightness(1.05);
        }
        .btn-sm {
          border-radius: 20px;
          font-weight: 600;
          padding: 6px 16px;
        }
        .dropdown-menu {
          box-shadow: 0 6px 12px rgba(0,0,0,0.12);
          border-radius: 8px;
          transition: all 0.3s ease-in-out;
        }
        .page-link {
          border-radius: 6px !important;
        }
    </style>

</head>
<body class="bg-white">

<!-- üß≠ HEADER -->
<header class="bg-light p-3 shadow-sm">
    <div class="container-fluid d-flex align-items-center justify-content-between flex-wrap gap-3">
        <h3 class="mb-0">üìö Hi·ªáu S√°ch C·ªßa Hi·ªáp</h3>

        <form th:action="@{/home_after_user_login/search}" method="get" class="d-flex flex-grow-1 mx-3" style="max-width: 600px;">
            <input type="text" name="keyword" class="form-control me-2" placeholder="T√¨m s√°ch theo t√™n, t√°c gi·∫£, th·ªÉ lo·∫°i...">
            <button type="submit" class="btn btn-primary">T√¨m ki·∫øm</button>
        </form>

        <div class="d-flex align-items-center gap-3">
            <div class="dropdown">
                <a href="#" class="d-block dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                    <img th:src="@{/images/sach-anh-dep3.jpg}" alt="Avatar" width="40" height="40" class="rounded-circle border">
                </a>
                <ul class="dropdown-menu dropdown-menu-end">
                    <li><a class="dropdown-item" href="#">üßë‚Äçüíº Trang c√° nh√¢n</a></li>
                    <li><a class="dropdown-item" href="#">X√°c th·ª±c Email</a></li>
                    <li><a class="dropdown-item" href="#">Gi·ªè h√†ng</a></li>
                    <li><a class="dropdown-item" href="#">L·ªãch s·ª≠ mua h√†ng</a></li>
                    <li><a class="dropdown-item" href="#">‚öôÔ∏è C√†i ƒë·∫∑t</a></li>
                    <li><hr class="dropdown-divider"></li>
                    <li><a class="dropdown-item text-danger" href="#">üö™ ƒêƒÉng xu·∫•t</a></li>
                </ul>
            </div>
        </div>
    </div>
</header>

<!-- üîó NAVIGATION -->
<nav class="bg-white border-bottom py-3">
    <div class="container-fluid d-flex gap-4 flex-wrap align-items-center">
        <a th:href="@{/home_user_after_login}" class="text-decoration-none">üè† Trang ch·ªß</a>

        <form th:action="@{/home_after_user_login/category}" method="get">
            <label for="categorySelect">üìö Th·ªÉ lo·∫°i:</label>
            <select name="category" id="categorySelect" class="form-select form-select-sm d-inline w-auto" onchange="this.form.submit()">
                <option value="" disabled th:selected="${category == null}">-- Ch·ªçn th·ªÉ lo·∫°i --</option>
                <option th:each="cat : ${categories}" th:value="${cat}" th:text="${cat}" th:selected="${cat == category}"></option>
            </select>
        </form>

        <form th:action="@{/home_after_user_login/author}" method="get">
            <label for="authorSelect">üë§ T√°c gi·∫£:</label>
            <select name="name_author" id="authorSelect" class="form-select form-select-sm d-inline w-auto" onchange="this.form.submit()">
                <option value="" disabled th:selected="${author == null}">-- Ch·ªçn t√°c gi·∫£ --</option>
                <option th:each="author : ${authors}" th:value="${author}" th:text="${author}" th:selected="${author == name_author}"></option>
            </select>
        </form>

        <form th:action="@{/home_after_user_login/topic}" method="get">
            <label for="topicSelect">üí° Ch·ªß ƒë·ªÅ:</label>
            <select name="name_topic" id="topicSelect" class="form-select form-select-sm d-inline w-auto" onchange="this.form.submit()">
                <option value="" disabled th:selected="${topic == null}">-- Ch·ªçn ch·ªß ƒë·ªÅ --</option>
                <option th:each="topic : ${topics}" th:value="${topic}" th:text="${topic}" th:selected="${topic == name_topic}"></option>
            </select>
        </form>

        <form method="get" th:action="@{/home_user_after_login}">
            <div class="dropdown">
                <label>Hi·ªÉn th·ªã</label>
                <select name="valueSize" onchange="this.form.submit()">
                    <option th:value="10" th:text="10" th:selected="${valueSize == 10}"></option>
                    <option th:value="5" th:text="5" th:selected="${valueSize == 5}"></option>
                    <option th:value="15" th:text="15" th:selected="${valueSize == 15}"></option>
                </select>
            </div>
            <!-- Gi·ªØ nguy√™n trang hi·ªán t·∫°i -->
            <input type="hidden" name="valuePage" th:value="${valuePage}" />
        </form>
    </div>
</nav>

<!-- üìò MAIN CONTENT -->
<main class="container my-4">
    <div class="row g-4">
        <div th:if="${notFound}">
            <p> Kh√¥ng t√¨m th·∫•y cu·ªën s√°ch n√†o! </p>
        </div>
        <div class="col-md-4" th:each="book : ${books.content}">
            <div class="card shadow-sm h-100 book-card">
                <a th:href="@{/homepage/information_book(bookid=${book.bookId})}">
                    <img th:src="@{/images/sach-anh-dep3.jpg}" th:alt="${book.nameBook}" class="card-img-top rounded-top">
                </a>
                <div class="card-body">
                    <h5 class="card-title" th:text="${book.nameBook}">T√™n s√°ch</h5>
                    <p class="card-text mb-1">üë§ <strong>T√°c gi·∫£:</strong> <span th:text="${book.nameAuthor}"></span></p>
                    <p class="card-text mb-1">üåê <strong>Ng√¥n ng·ªØ:</strong> <span th:text="${book.language}"></span></p>
                    <p class="card-text mb-1">üí° <strong>Ch·ªß ƒë·ªÅ:</strong> <span th:text="${book.nameTopic}"></span></p>
                    <p class="card-text mb-0">üìö <strong>Th·ªÉ lo·∫°i:</strong> <span th:text="${book.nameCategory}"></span></p>
                    <p class="card-text mb-0">üìö <strong>S·ªë l∆∞·ª£ng:</strong> <span th:text="${book.quantity}"></span></p>
                </div>
                <div class="card-footer bg-white d-flex justify-content-center gap-2 py-3">
                    <form method="post" th:action="@{/add-to-cart}">
                        <button type="submit" class="btn btn-outline-primary btn-sm">üõí Th√™m v√†o gi·ªè</button>
                    </form>
                    <a th:href="@{/home_after_user_login/switch_buy_now(bookId=${book.bookId})}"  class="btn btn-success btn-sm">üí≥ Mua ngay</a>

                </div>
            </div>
        </div>
    </div>
</main>

<nav aria-label="Pagination">
    <ul class="pagination justify-content-center">
        <li class="page-item" th:classappend="${valuePage==0} ? 'disabled'">
            <a class="page-link" th:href="@{/home_user_after_login(valuePage=${valuePage-1}, valueSize=${valueSize})}" >Previous</a>
        </li>
        <li class="page-item" th:each="p : ${#numbers.sequence(0,totalPage - 1)}" th:classappend="${p == valuePage} ? 'active'">
            <a class="page-link" th:href="@{/home_user_after_login(valuePage=${p}, valueSize=${valueSize})}" th:text="${p+1}"  ></a>
        </li>
        <li class="page-item" th:classappend="${valuePage== (totalPage - 1)} ? 'disabled'">
            <a class="page-link" th:href="@{/home_user_after_login(valuePage=${valuePage+1}, valueSize=${valueSize})}">Next</a>
        </li>
    </ul>
</nav>

<!-- üìå FOOTER -->
<footer>
    <p class="text-muted mb-0">¬© 2025 Hi·ªáu S√°ch C·ªßa Hi·ªáp. M·ªçi quy·ªÅn ƒë∆∞·ª£c b·∫£o l∆∞u.</p>
</footer>

<!-- JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
